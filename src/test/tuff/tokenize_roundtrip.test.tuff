from std::test use { reset, suite, it, expect_eq, summary, status };

from src::main::tuff::compiler::lexing use {
  tokenize_with_trivia,
  emit_token_stream
};

fn main() : I32 => {
  reset();
  suite("tokenize + trivia roundtrip");

  // Mixed trivia + operators + strings.
  let src = "// leading\nfn main() => {\n  let x=1+2;  /* mid */\n  let y = x==3 && x!=4 || x<=5 || x>=6;\n  let s = \"a\\\"b\";\n  x + y\n}\n";

  let ts = tokenize_with_trivia(src);
  let out = emit_token_stream(ts);

  it("roundtrips exactly", expect_eq("src", out, src));

  summary();
  status()
}
