from std::test use { reset, suite, it, expect_eq, summary, status };

from src::main::tuff::compiler::util::formatting use { parse_program_with_trivia };
from src::main::tuff::compiler::util::lexing use { emit_token_stream };

out fn run() : I32 => {
  reset();
  suite("formatting parse_program_with_trivia");

  let src = "// header\nextern from rt::vec use { vec_new, vec_push };\nfrom std::test use { reset };\nfn main() => { let x = 1 + 2; x }\n";

  let p = parse_program_with_trivia(src, false);
  let out = emit_token_stream(p.tokenStream);

  it("token stream roundtrips", expect_eq("src", out, src));

  summary();
  status()
}
