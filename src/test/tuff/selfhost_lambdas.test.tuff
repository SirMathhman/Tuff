from std::test use { reset, suite, it, expect_eq, summary, status };

fn main() : I32 => {
  reset();
  suite("lambdas");

  it("typed lambda adds", {
    let add = (a: I32, b: I32) : I32 => a + b;
    expect_eq("add(3,4)", add(3, 4), 7)
  });

  it("typed lambda no params", {
    let ten = () : I32 => 10;
    expect_eq("ten()", ten(), 10)
  });

  it("typed lambda block body", {
    let compute = (x: I32) : I32 => {
      let y = x * 2;
      y + 1
    };
    expect_eq("compute(5)", compute(5), 11)
  });

  it("typed lambda inline call", {
    let v = ((n: I32) : I32 => n + 100)(5);
    expect_eq("inline", v, 105)
  });

  it("untyped lambda params", {
    let add = (a, b) => a + b;
    expect_eq("add(2,3)", add(2, 3), 5)
  });

  it("untyped lambda no params", {
    let ten = () => 10;
    expect_eq("ten()", ten(), 10)
  });

  it("typed params, inferred return", {
    let inc = (x: I32) => x + 1;
    expect_eq("inc(10)", inc(10), 11)
  });

  it("mixed typed/untyped params", {
    let add = (a: I32, b) => a + b;
    expect_eq("add(1,2)", add(1, 2), 3)
  });

  summary();
  status()
}
